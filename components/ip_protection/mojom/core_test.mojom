// Copyright 2025 The Chromium Authors
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.

module ip_protection.mojom;

import "components/ip_protection/mojom/data_types.mojom";
import "mojo/public/mojom/base/time.mojom";
import "url/mojom/url.mojom";

// Testing support for the IP Protection state in the network service process.
interface CoreControlTest {
  // Testing support.
  VerifyIpProtectionCoreHostForTesting()
      => (BlindSignedAuthToken? bsa_token,
          mojo_base.mojom.Time? try_again_after);

  // Check whether IP Protection is enabled in the core, for testing.
  IsIpProtectionEnabledForTesting() => (bool value);

  // Gets a token from the cache for the given proxy layer and geo.
  // Specifying the geo allows tests to validate cache contents even if the
  // current geo has not yet been detected (i.e. the proxy config has not been
  // fetched).
  GetAuthTokenForTesting(ProxyLayer proxy_layer, string geo_id)
      => (BlindSignedAuthToken? token);

  // Check whether IP Protection has any bypasses set by User Bypass
  HasTrackingProtectionExceptionForTesting(url.mojom.Url first_party_url)
      => (bool has_exception);
};
