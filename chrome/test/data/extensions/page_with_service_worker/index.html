<!--
Copyright 2025 The Chromium Authors
Use of this source code is governed by a BSD-style license that can be
found in the LICENSE file.
-->
<!DOCTYPE html>
<html lang="en">
  <body>
    Some text
  </body>
  <script>
    // Waits for the service worker to claim this page as a client.
    async function waitForClaim() {
      await (new Promise((resolve) => {
        // It's possible the service worker already claimed the page as a
        // client. If so, resolve immediately.
        if (navigator.serviceWorker.controller) {
          resolve();
          return;
        }

        // Wait for the service worker to take over as the controller.
        navigator.serviceWorker.addEventListener(
            'controllerchange', resolve, {once: true});
      }));
    }
    // Register the service worker and wait for it to take control
    addEventListener('load', async () => {
      await navigator.serviceWorker.register('./service_worker.js');
      const registration = await navigator.serviceWorker.ready;
      await waitForClaim();
      domAutomationController.send('ready');
    });
  </script>
</body>
</html>
